{"ast":null,"code":"var _jsxFileName = \"D:\\\\COURS\\\\S5\\\\Rojo\\\\Projet\\\\Ionic\\\\template\\\\ionic1\\\\src\\\\pages\\\\Login.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useRef } from 'react';\nimport { IonHeader, IonPage, IonToolbar, IonTitle, IonContent, IonItem, IonLabel, IonInput, IonButton } from '@ionic/react';\nimport { RemoteService } from '../services/remote.service';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst LoginPage = _ref => {\n  _s();\n\n  let {\n    history\n  } = _ref;\n  const remoteService = new RemoteService();\n  const [error, setError] = useState({\n    error: false\n  });\n  const loginForm = useRef(null);\n  useEffect(() => {\n    let token = sessionStorage.getItem('userToken');\n    let username;\n    console.log('loginForm :', loginForm);\n\n    if (loginForm && loginForm.current) {\n      loginForm.current.reset();\n    }\n\n    if (token) {\n      history.push('/home');\n    } else {\n      history.push('/login');\n    }\n  }, []); // if(!sessionStorage.getItem(\"Token\")){\n  //     history.push('../App');\n  // }\n\n  const handleSubmit = event => {\n    event.preventDefault(); // Syntax : var formData = new FormData(form)\n    // Ref : https://medium.com/@everdimension/how-to-handle-forms-with-just-react-ac066c48bd4f\n\n    const form = event.target.closest('form');\n    const formData = new FormData(form);\n    const formDataObj = {\n      username: formData.get('email'),\n      password: formData.get('mdp')\n    };\n    const options = {\n      endPoint: `login`,\n      restOfUrl: '',\n      isSecure: true,\n      contentType: 'application/json'\n    };\n    remoteService.request('POST', options, formDataObj).then(data => {\n      data.username = formDataObj.username;\n\n      if (data.username == \"aa\") {\n        console.log(\"yes\");\n        sessionStorage.setItem('Token', \"aa\");\n        history.push('/home');\n      } else {\n        alert(\"mots de passe incorrect\");\n      }\n    }); // const options: IUrlOptions = {\n    //     endPoint: ``,\n    //     restOfUrl: '',\n    //     isSecure: true,\n    //     contentType: 'application/json'\n    // };\n    // remoteService.request('GET', options).then((data) => {\n    //     if (formDataObj.password ==\"aa\") {\n    //                 // data.username =\"aa\";\n    //                 // console.log(\"yes\");\n    //                 sessionStorage.setItem('Token', \"aa\");\n    //                 history.push('/home');\n    //     }\n    //             else{\n    //                 alert(\"mots de passe incorrect\");\n    //             }\n    // })\n  };\n\n  return /*#__PURE__*/_jsxDEV(IonPage, {\n    children: [/*#__PURE__*/_jsxDEV(IonHeader, {\n      children: /*#__PURE__*/_jsxDEV(IonToolbar, {\n        children: /*#__PURE__*/_jsxDEV(IonTitle, {\n          children: \"Connectez vous pour signaler\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(IonContent, {\n      children: /*#__PURE__*/_jsxDEV(\"form\", {\n        ref: loginForm,\n        name: \"formLogin\",\n        id: \"formLogin\",\n        method: \"POST\",\n        onSubmit: handleSubmit,\n        encType: \"multipart/form-data\",\n        children: [/*#__PURE__*/_jsxDEV(IonItem, {\n          children: [/*#__PURE__*/_jsxDEV(IonLabel, {\n            position: \"floating\",\n            children: \"E-mail\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 113,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(IonInput, {\n            placeholder: \"example@gmail.com\",\n            type: \"text\",\n            name: \"email\",\n            id: \"email\",\n            autocomplete: \"off\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 114,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(IonItem, {\n          children: [/*#__PURE__*/_jsxDEV(IonLabel, {\n            position: \"floating\",\n            children: \"mot de passe\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 117,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(IonInput, {\n            type: \"password\",\n            name: \"mdp\",\n            id: \"mdp\",\n            autocomplete: \"off\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 118,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"button-wrapper\",\n          children: /*#__PURE__*/_jsxDEV(IonButton, {\n            type: \"submit\",\n            children: \"Login\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 121,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 102,\n    columnNumber: 9\n  }, this);\n}; // export default Details;\n\n\n_s(LoginPage, \"Cvm7CWrsXpZ1aw/V0UCV2/ny9+A=\");\n\n_c = LoginPage;\nexport default LoginPage;\n\nvar _c;\n\n$RefreshReg$(_c, \"LoginPage\");","map":{"version":3,"sources":["D:/COURS/S5/Rojo/Projet/Ionic/template/ionic1/src/pages/Login.tsx"],"names":["React","useState","useEffect","useRef","IonHeader","IonPage","IonToolbar","IonTitle","IonContent","IonItem","IonLabel","IonInput","IonButton","RemoteService","LoginPage","history","remoteService","error","setError","loginForm","token","sessionStorage","getItem","username","console","log","current","reset","push","handleSubmit","event","preventDefault","form","target","closest","formData","FormData","formDataObj","get","password","options","endPoint","restOfUrl","isSecure","contentType","request","then","data","setItem","alert"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport {\r\n    IonHeader,\r\n    IonPage,\r\n    IonToolbar,\r\n    IonTitle,\r\n    IonContent,\r\n    IonItem,\r\n    IonLabel,\r\n    IonInput,\r\n    IonButton\r\n} from '@ionic/react';\r\nimport { IUrlOptions } from '../models/rest-api.model';\r\nimport { RemoteService } from '../services/remote.service';\r\nimport { useHistory } from \"react-router-dom\";\r\n\r\nconst LoginPage: React.FC = ({ history }: any) => {\r\n    const remoteService = new RemoteService();\r\n    const [error, setError] = useState({ error: false });\r\n    const loginForm = useRef<HTMLFormElement>(null);\r\n\r\n    useEffect(() => {\r\n        let token = sessionStorage.getItem('userToken');\r\n        let username;\r\n        console.log('loginForm :', loginForm);\r\n        if (loginForm && loginForm.current) {\r\n            loginForm.current.reset();\r\n        }\r\n        if (token) {\r\n            history.push('/home');\r\n        } else {\r\n            history.push('/login');\r\n        }\r\n    }, []);\r\n        \r\n    // if(!sessionStorage.getItem(\"Token\")){\r\n    //     history.push('../App');\r\n    // }\r\n\r\n    const handleSubmit = (event: any) => {\r\n        event.preventDefault();\r\n\r\n        // Syntax : var formData = new FormData(form)\r\n        // Ref : https://medium.com/@everdimension/how-to-handle-forms-with-just-react-ac066c48bd4f\r\n        const form = event.target.closest('form');\r\n        const formData = new FormData(form);\r\n\r\n        const formDataObj = {\r\n            username: formData.get('email'),\r\n            password: formData.get('mdp')\r\n        };\r\n\r\n        const options: IUrlOptions = {\r\n            endPoint: `login`,\r\n            restOfUrl: '',\r\n            isSecure: true,\r\n            contentType: 'application/json'\r\n        };\r\n\r\n        remoteService.request('POST', options, formDataObj).then((data) => {\r\n            data.username =formDataObj.username;\r\n\r\n            if (data.username ==\"aa\") {\r\n                 console.log(\"yes\");\r\n                \r\n                \r\n                sessionStorage.setItem('Token', \"aa\");\r\n\r\n                history.push('/home');\r\n            }\r\n            else{\r\n                alert(\"mots de passe incorrect\");\r\n            }\r\n        });\r\n        // const options: IUrlOptions = {\r\n        //     endPoint: ``,\r\n        //     restOfUrl: '',\r\n        //     isSecure: true,\r\n        //     contentType: 'application/json'\r\n        // };\r\n\r\n        // remoteService.request('GET', options).then((data) => {\r\n        //     if (formDataObj.password ==\"aa\") {\r\n        //                 // data.username =\"aa\";\r\n        //                 // console.log(\"yes\");\r\n                        \r\n                        \r\n        //                 sessionStorage.setItem('Token', \"aa\");\r\n        \r\n        //                 history.push('/home');\r\n        //     }\r\n        //             else{\r\n        //                 alert(\"mots de passe incorrect\");\r\n        //             }\r\n        // })\r\n\r\n    }\r\n\r\n\r\n    \r\n    return (\r\n        <IonPage>\r\n\r\n            <IonHeader>\r\n                <IonToolbar>\r\n                    <IonTitle>Connectez vous pour signaler</IonTitle>\r\n                </IonToolbar>\r\n            </IonHeader>\r\n\r\n            <IonContent>\r\n                <form ref={loginForm} name=\"formLogin\" id=\"formLogin\" method=\"POST\" onSubmit={handleSubmit} encType=\"multipart/form-data\" >\r\n                    <IonItem>\r\n                        <IonLabel position=\"floating\">E-mail</IonLabel>\r\n                        <IonInput placeholder=\"example@gmail.com\" type=\"text\" name=\"email\" id=\"email\" autocomplete=\"off\"></IonInput>\r\n                    </IonItem>\r\n                    <IonItem>\r\n                        <IonLabel position=\"floating\" >mot de passe</IonLabel>\r\n                        <IonInput  type=\"password\" name=\"mdp\" id=\"mdp\" autocomplete=\"off\"></IonInput>\r\n                    </IonItem>\r\n                    <div className=\"button-wrapper\">\r\n                        <IonButton type=\"submit\">Login</IonButton>\r\n                    </div>\r\n                </form>\r\n            </IonContent>\r\n        </IonPage>\r\n    );\r\n};\r\n\r\n// export default Details;\r\nexport default LoginPage;\r\n"]},"metadata":{},"sourceType":"module"}